#ifndef DEDXCALCULATOR_CXX
#define DEDXCALCULATOR_CXX

#include "dEdxCalculator.h"
#include <cassert>
#include <cmath>

namespace llcv {

  dEdxCalculator::dEdxCalculator() {
    //
    // https://goo.gl/oXkRQU
    //

    //
    // fill muon 
    // this curve matches MC expectation very well
    //
    _muon_m[90.50] = 2.07;
    _muon_m[90.00] = 2.07;
    _muon_m[89.50] = 2.07;
    _muon_m[89.00] = 2.07;
    _muon_m[88.50] = 2.07;
    _muon_m[88.00] = 2.07;
    _muon_m[87.50] = 2.07;
    _muon_m[87.00] = 2.07;
    _muon_m[86.50] = 2.07;
    _muon_m[86.00] = 2.07;
    _muon_m[85.50] = 2.07;
    _muon_m[85.00] = 2.07;
    _muon_m[84.50] = 2.07;
    _muon_m[84.00] = 2.07;
    _muon_m[83.50] = 2.07;
    _muon_m[83.00] = 2.07;
    _muon_m[82.50] = 2.07;
    _muon_m[82.00] = 2.07;
    _muon_m[81.50] = 2.07;
    _muon_m[81.00] = 2.07;
    _muon_m[80.50] = 2.07;
    _muon_m[80.00] = 2.07;
    _muon_m[79.50] = 2.08;
    _muon_m[79.00] = 2.08;
    _muon_m[78.50] = 2.08;
    _muon_m[78.00] = 2.08;
    _muon_m[77.50] = 2.08;
    _muon_m[77.00] = 2.08;
    _muon_m[76.50] = 2.08;
    _muon_m[76.00] = 2.08;
    _muon_m[75.50] = 2.08;
    _muon_m[75.00] = 2.08;
    _muon_m[74.50] = 2.08;
    _muon_m[74.00] = 2.08;
    _muon_m[73.50] = 2.08;
    _muon_m[73.00] = 2.08;
    _muon_m[72.50] = 2.08;
    _muon_m[72.00] = 2.08;
    _muon_m[71.50] = 2.08;
    _muon_m[71.00] = 2.08;
    _muon_m[70.50] = 2.09;
    _muon_m[70.00] = 2.09;
    _muon_m[69.50] = 2.09;
    _muon_m[69.00] = 2.09;
    _muon_m[68.50] = 2.09;
    _muon_m[68.00] = 2.09;
    _muon_m[67.50] = 2.09;
    _muon_m[67.00] = 2.09;
    _muon_m[66.50] = 2.09;
    _muon_m[66.00] = 2.09;
    _muon_m[65.50] = 2.09;
    _muon_m[65.00] = 2.09;
    _muon_m[64.50] = 2.10;
    _muon_m[64.00] = 2.10;
    _muon_m[63.50] = 2.10;
    _muon_m[63.00] = 2.10;
    _muon_m[62.50] = 2.10;
    _muon_m[62.00] = 2.10;
    _muon_m[61.50] = 2.10;
    _muon_m[61.00] = 2.10;
    _muon_m[60.50] = 2.10;
    _muon_m[60.00] = 2.11;
    _muon_m[59.50] = 2.11;
    _muon_m[59.00] = 2.11;
    _muon_m[58.50] = 2.11;
    _muon_m[58.00] = 2.11;
    _muon_m[57.50] = 2.11;
    _muon_m[57.00] = 2.11;
    _muon_m[56.50] = 2.11;
    _muon_m[56.00] = 2.12;
    _muon_m[55.50] = 2.12;
    _muon_m[55.00] = 2.12;
    _muon_m[54.50] = 2.12;
    _muon_m[54.00] = 2.12;
    _muon_m[53.50] = 2.12;
    _muon_m[53.00] = 2.13;
    _muon_m[52.50] = 2.13;
    _muon_m[52.00] = 2.13;
    _muon_m[51.50] = 2.13;
    _muon_m[51.00] = 2.13;
    _muon_m[50.50] = 2.14;
    _muon_m[50.00] = 2.14;
    _muon_m[49.50] = 2.14;
    _muon_m[49.00] = 2.14;
    _muon_m[48.50] = 2.14;
    _muon_m[48.00] = 2.15;
    _muon_m[47.50] = 2.15;
    _muon_m[47.00] = 2.15;
    _muon_m[46.50] = 2.15;
    _muon_m[46.00] = 2.16;
    _muon_m[45.50] = 2.16;
    _muon_m[45.00] = 2.16;
    _muon_m[44.50] = 2.16;
    _muon_m[44.00] = 2.17;
    _muon_m[43.50] = 2.17;
    _muon_m[43.00] = 2.17;
    _muon_m[42.50] = 2.18;
    _muon_m[42.00] = 2.18;
    _muon_m[41.50] = 2.18;
    _muon_m[41.00] = 2.19;
    _muon_m[40.50] = 2.19;
    _muon_m[40.00] = 2.19;
    _muon_m[39.50] = 2.20;
    _muon_m[39.00] = 2.20;
    _muon_m[38.50] = 2.20;
    _muon_m[38.00] = 2.21;
    _muon_m[37.50] = 2.21;
    _muon_m[37.00] = 2.22;
    _muon_m[36.50] = 2.22;
    _muon_m[36.00] = 2.23;
    _muon_m[35.50] = 2.23;
    _muon_m[35.00] = 2.23;
    _muon_m[34.50] = 2.24;
    _muon_m[34.00] = 2.24;
    _muon_m[33.50] = 2.25;
    _muon_m[33.00] = 2.25;
    _muon_m[32.50] = 2.26;
    _muon_m[32.00] = 2.27;
    _muon_m[31.50] = 2.27;
    _muon_m[31.00] = 2.28;
    _muon_m[30.50] = 2.28;
    _muon_m[30.00] = 2.29;
    _muon_m[29.50] = 2.30;
    _muon_m[29.00] = 2.30;
    _muon_m[28.50] = 2.31;
    _muon_m[28.00] = 2.32;
    _muon_m[27.50] = 2.33;
    _muon_m[27.00] = 2.33;
    _muon_m[26.50] = 2.34;
    _muon_m[26.00] = 2.35;
    _muon_m[25.50] = 2.36;
    _muon_m[25.00] = 2.37;
    _muon_m[24.50] = 2.38;
    _muon_m[24.00] = 2.39;
    _muon_m[23.50] = 2.40;
    _muon_m[23.00] = 2.41;
    _muon_m[22.50] = 2.42;
    _muon_m[22.00] = 2.43;
    _muon_m[21.50] = 2.44;
    _muon_m[21.00] = 2.45;
    _muon_m[20.50] = 2.47;
    _muon_m[20.00] = 2.48;
    _muon_m[19.50] = 2.49;
    _muon_m[19.00] = 2.51;
    _muon_m[18.50] = 2.52;
    _muon_m[18.00] = 2.54;
    _muon_m[17.50] = 2.56;
    _muon_m[17.00] = 2.57;
    _muon_m[16.50] = 2.59;
    _muon_m[16.00] = 2.61;
    _muon_m[15.50] = 2.63;
    _muon_m[15.00] = 2.66;
    _muon_m[14.50] = 2.68;
    _muon_m[14.00] = 2.70;
    _muon_m[13.50] = 2.73;
    _muon_m[13.00] = 2.76;
    _muon_m[12.50] = 2.79;
    _muon_m[12.00] = 2.82;
    _muon_m[11.50] = 2.85;
    _muon_m[11.00] = 2.89;
    _muon_m[10.50] = 2.93;
    _muon_m[10.00] = 2.97;
    _muon_m[9.50] = 3.02;
    _muon_m[9.00] = 3.07;
    _muon_m[8.50] = 3.12;
    _muon_m[8.00] = 3.18;
    _muon_m[7.50] = 3.25;
    _muon_m[7.00] = 3.32;
    _muon_m[6.50] = 3.40;
    _muon_m[6.00] = 3.49;
    _muon_m[5.50] = 3.60;
    _muon_m[5.00] = 3.72;
    _muon_m[4.50] = 3.86;
    _muon_m[4.00] = 4.03;
    _muon_m[3.50] = 4.23;
    _muon_m[3.00] = 4.49;
    _muon_m[2.50] = 4.81;
    _muon_m[2.00] = 5.24;
    _muon_m[1.50] = 5.87;
    _muon_m[1.00] = 6.89;
    _muon_m[0.50] = 8.92;
    _muon_m[0.00] = 16.29;;
    
    //
    // fill proton
    // this MC curve sucks
    //
    _proton_m[84.5] = 3.00;
    _proton_m[84.0] = 3.01;
    _proton_m[83.5] = 3.01;
    _proton_m[83.0] = 3.02;
    _proton_m[82.5] = 3.02;
    _proton_m[82.0] = 3.03;
    _proton_m[81.5] = 3.03;
    _proton_m[81.0] = 3.04;
    _proton_m[80.5] = 3.05;
    _proton_m[80.0] = 3.05;
    _proton_m[79.5] = 3.06;
    _proton_m[79.0] = 3.06;
    _proton_m[78.5] = 3.07;
    _proton_m[78.0] = 3.08;
    _proton_m[77.5] = 3.08;
    _proton_m[77.0] = 3.09;
    _proton_m[76.5] = 3.09;
    _proton_m[76.0] = 3.10;
    _proton_m[75.5] = 3.11;
    _proton_m[75.0] = 3.11;
    _proton_m[74.5] = 3.12;
    _proton_m[74.0] = 3.12;
    _proton_m[73.5] = 3.13;
    _proton_m[73.0] = 3.14;
    _proton_m[72.5] = 3.14;
    _proton_m[72.0] = 3.15;
    _proton_m[71.5] = 3.16;
    _proton_m[71.0] = 3.17;
    _proton_m[70.5] = 3.17;
    _proton_m[70.0] = 3.18;
    _proton_m[69.5] = 3.19;
    _proton_m[69.0] = 3.19;
    _proton_m[68.5] = 3.20;
    _proton_m[68.0] = 3.21;
    _proton_m[67.5] = 3.22;
    _proton_m[67.0] = 3.22;
    _proton_m[66.5] = 3.23;
    _proton_m[66.0] = 3.24;
    _proton_m[65.5] = 3.25;
    _proton_m[65.0] = 3.25;
    _proton_m[64.5] = 3.26;
    _proton_m[64.0] = 3.27;
    _proton_m[63.5] = 3.28;
    _proton_m[63.0] = 3.29;
    _proton_m[62.5] = 3.30;
    _proton_m[62.0] = 3.30;
    _proton_m[61.5] = 3.31;
    _proton_m[61.0] = 3.32;
    _proton_m[60.5] = 3.33;
    _proton_m[60.0] = 3.34;
    _proton_m[59.5] = 3.35;
    _proton_m[59.0] = 3.36;
    _proton_m[58.5] = 3.37;
    _proton_m[58.0] = 3.38;
    _proton_m[57.5] = 3.39;
    _proton_m[57.0] = 3.40;
    _proton_m[56.5] = 3.41;
    _proton_m[56.0] = 3.42;
    _proton_m[55.5] = 3.43;
    _proton_m[55.0] = 3.44;
    _proton_m[54.5] = 3.45;
    _proton_m[54.0] = 3.46;
    _proton_m[53.5] = 3.47;
    _proton_m[53.0] = 3.48;
    _proton_m[52.5] = 3.49;
    _proton_m[52.0] = 3.50;
    _proton_m[51.5] = 3.51;
    _proton_m[51.0] = 3.52;
    _proton_m[50.5] = 3.54;
    _proton_m[50.0] = 3.55;
    _proton_m[49.5] = 3.56;
    _proton_m[49.0] = 3.57;
    _proton_m[48.5] = 3.58;
    _proton_m[48.0] = 3.60;
    _proton_m[47.5] = 3.61;
    _proton_m[47.0] = 3.62;
    _proton_m[46.5] = 3.64;
    _proton_m[46.0] = 3.65;
    _proton_m[45.5] = 3.66;
    _proton_m[45.0] = 3.68;
    _proton_m[44.5] = 3.69;
    _proton_m[44.0] = 3.71;
    _proton_m[43.5] = 3.72;
    _proton_m[43.0] = 3.74;
    _proton_m[42.5] = 3.75;
    _proton_m[42.0] = 3.77;
    _proton_m[41.5] = 3.78;
    _proton_m[41.0] = 3.80;
    _proton_m[40.5] = 3.82;
    _proton_m[40.0] = 3.83;
    _proton_m[39.5] = 3.85;
    _proton_m[39.0] = 3.87;
    _proton_m[38.5] = 3.89;
    _proton_m[38.0] = 3.90;
    _proton_m[37.5] = 3.92;
    _proton_m[37.0] = 3.94;
    _proton_m[36.5] = 3.96;
    _proton_m[36.0] = 3.98;
    _proton_m[35.5] = 4.00;
    _proton_m[35.0] = 4.02;
    _proton_m[34.5] = 4.04;
    _proton_m[34.0] = 4.06;
    _proton_m[33.5] = 4.09;
    _proton_m[33.0] = 4.11;
    _proton_m[32.5] = 4.13;
    _proton_m[32.0] = 4.15;
    _proton_m[31.5] = 4.18;
    _proton_m[31.0] = 4.20;
    _proton_m[30.5] = 4.23;
    _proton_m[30.0] = 4.26;
    _proton_m[29.5] = 4.28;
    _proton_m[29.0] = 4.31;
    _proton_m[28.5] = 4.34;
    _proton_m[28.0] = 4.37;
    _proton_m[27.5] = 4.40;
    _proton_m[27.0] = 4.43;
    _proton_m[26.5] = 4.46;
    _proton_m[26.0] = 4.49;
    _proton_m[25.5] = 4.52;
    _proton_m[25.0] = 4.56;
    _proton_m[24.5] = 4.59;
    _proton_m[24.0] = 4.63;
    _proton_m[23.5] = 4.67;
    _proton_m[23.0] = 4.71;
    _proton_m[22.5] = 4.75;
    _proton_m[22.0] = 4.79;
    _proton_m[21.5] = 4.83;
    _proton_m[21.0] = 4.88;
    _proton_m[20.5] = 4.92;
    _proton_m[20.0] = 4.97;
    _proton_m[19.5] = 5.02;
    _proton_m[19.0] = 5.07;
    _proton_m[18.5] = 5.13;
    _proton_m[18.0] = 5.18;
    _proton_m[17.5] = 5.24;
    _proton_m[17.0] = 5.30;
    _proton_m[16.5] = 5.37;
    _proton_m[16.0] = 5.43;
    _proton_m[15.5] = 5.50;
    _proton_m[15.0] = 5.58;
    _proton_m[14.5] = 5.66;
    _proton_m[14.0] = 5.74;
    _proton_m[13.5] = 5.83;
    _proton_m[13.0] = 5.92;
    _proton_m[12.5] = 6.01;
    _proton_m[12.0] = 6.12;
    _proton_m[11.5] = 6.23;
    _proton_m[11.0] = 6.35;
    _proton_m[10.5] = 6.47;
    _proton_m[10.0] = 6.61;
    _proton_m[9.50] = 6.75;
    _proton_m[9.00] = 6.91;
    _proton_m[8.50] = 7.09;
    _proton_m[8.00] = 7.28;
    _proton_m[7.50] = 7.48;
    _proton_m[7.00] = 7.71;
    _proton_m[6.50] = 7.97;
    _proton_m[6.00] = 8.26;
    _proton_m[5.50] = 8.59;
    _proton_m[5.00] = 8.97;
    _proton_m[4.50] = 9.41;
    _proton_m[4.00] = 9.94;
    _proton_m[3.50] = 10.58;
    _proton_m[3.00] = 11.38;
    _proton_m[2.50] = 12.42;
    _proton_m[2.00] = 13.86;
    _proton_m[1.50] = 16.00;
    _proton_m[1.00] = 19.72;
    _proton_m[0.50] = 28.53;
    _proton_m[0.00] = 129.59;
    
    //
    // fill proton fit from MC
    // this is from vic
    //
    _proton_fit_m[    0] =   3.45;
    _proton_fit_m[  0.5] =   7.8 ;
    _proton_fit_m[  1. ] =   7.4 ;
    _proton_fit_m[  1.5] =   7.4 ;
    _proton_fit_m[  2. ] =   7.4 ;
    _proton_fit_m[  2.5] =   6.95;
    _proton_fit_m[  3. ] =   6.8 ;
    _proton_fit_m[  3.5] =   6.75;
    _proton_fit_m[  4. ] =   6.55;
    _proton_fit_m[  4.5] =   6.25;
    _proton_fit_m[  5. ] =   6.4 ;
    _proton_fit_m[  5.5] =   5.95;
    _proton_fit_m[  6. ] =   5.9 ;
    _proton_fit_m[  6.5] =   5.8 ;
    _proton_fit_m[  7. ] =   5.6 ;
    _proton_fit_m[  7.5] =   5.7 ;
    _proton_fit_m[  8. ] =   5.6 ;
    _proton_fit_m[  8.5] =   5.45;
    _proton_fit_m[  9. ] =   5.15;
    _proton_fit_m[  9.5] =   5.15;
    _proton_fit_m[ 10. ] =   5.15;
    _proton_fit_m[ 10.5] =   5.15;
    _proton_fit_m[ 11. ] =   4.8 ;
    _proton_fit_m[ 11.5] =   4.75;
    _proton_fit_m[ 12. ] =   5.1 ;
    _proton_fit_m[ 12.5] =   5.05;
    _proton_fit_m[ 13. ] =   5.  ;
    _proton_fit_m[ 13.5] =   4.65;
    _proton_fit_m[ 14. ] =   4.7 ;
    _proton_fit_m[ 14.5] =   4.6 ;
    _proton_fit_m[ 15. ] =   4.6 ;
    _proton_fit_m[ 15.5] =   4.45;
    _proton_fit_m[ 16. ] =   4.55;
    _proton_fit_m[ 16.5] =   4.4 ;
    _proton_fit_m[ 17. ] =   4.35;
    _proton_fit_m[ 17.5] =   4.5 ;
    _proton_fit_m[ 18. ] =   4.3 ;
    _proton_fit_m[ 18.5] =   4.3 ;
    _proton_fit_m[ 19. ] =   4.3 ;
    _proton_fit_m[ 19.5] =   4.5 ;
    _proton_fit_m[ 20. ] =   4.25;
    _proton_fit_m[ 20.5] =   4.55;
    _proton_fit_m[ 21. ] =   4.25;
    _proton_fit_m[ 21.5] =   4.2 ;
    _proton_fit_m[ 22. ] =   4.2 ;
    _proton_fit_m[ 22.5] =   4.15;
    _proton_fit_m[ 23. ] =   4.55;
    _proton_fit_m[ 23.5] =   4.05;
    _proton_fit_m[ 24. ] =   4.1 ;
    _proton_fit_m[ 24.5] =   4.  ;
    _proton_fit_m[ 25. ] =   4.  ;
    _proton_fit_m[ 25.5] =   4.15;
    _proton_fit_m[ 26. ] =   4.1 ;
    _proton_fit_m[ 26.5] =   4.1 ;
    _proton_fit_m[ 27. ] =   4.1 ;
    _proton_fit_m[ 27.5] =   4.1 ;
    _proton_fit_m[ 28. ] =   4.1 ;
    _proton_fit_m[ 28.5] =   4.1 ;
    _proton_fit_m[ 29. ] =   4.1 ;
    _proton_fit_m[ 29.5] =   4.1 ;
    _proton_fit_m[ 30. ] =   4.2 ;
    _proton_fit_m[ 30.5] =   4.2 ;
    _proton_fit_m[ 31. ] =   3.95;
    _proton_fit_m[ 31.5] =   3.95;
    _proton_fit_m[ 32. ] =   3.95;
    _proton_fit_m[ 32.5] =   3.85;
    _proton_fit_m[ 33. ] =   4.  ;
    _proton_fit_m[ 33.5] =   3.85;
    _proton_fit_m[ 34. ] =   3.95;
    _proton_fit_m[ 34.5] =   3.9 ;
    _proton_fit_m[ 35. ] =   3.9 ;
    _proton_fit_m[ 35.5] =   3.9 ;
    _proton_fit_m[ 36. ] =   3.9 ;
    _proton_fit_m[ 36.5] =   3.8 ;
    _proton_fit_m[ 37. ] =   3.6 ;
    _proton_fit_m[ 37.5] =   3.6 ;
    _proton_fit_m[ 38. ] =   3.75;
    _proton_fit_m[ 38.5] =   3.85;
    _proton_fit_m[ 39. ] =   3.75;
    _proton_fit_m[ 39.5] =   3.75;
    _proton_fit_m[ 40. ] =   3.7 ;
    _proton_fit_m[ 40.5] =   3.7 ;
    _proton_fit_m[ 41. ] =   3.6 ;
    _proton_fit_m[ 41.5] =   3.65;
    _proton_fit_m[ 42. ] =   3.6 ;
    _proton_fit_m[ 42.5] =   3.6 ;
    _proton_fit_m[ 43. ] =   3.65;
    _proton_fit_m[ 43.5] =   3.65;
    _proton_fit_m[ 44. ] =   3.65;
    _proton_fit_m[ 44.5] =   3.65;
    _proton_fit_m[ 45. ] =   3.4 ;
    _proton_fit_m[ 45.5] =   3.4 ;
    _proton_fit_m[ 46. ] =   3.45;
    _proton_fit_m[ 46.5] =   3.7 ;
    _proton_fit_m[ 47. ] =   3.35;
    _proton_fit_m[ 47.5] =   3.35;
    _proton_fit_m[ 48. ] =   3.45;
    _proton_fit_m[ 48.5] =   3.45;
    _proton_fit_m[ 49. ] =   3.45;
    _proton_fit_m[ 49.5] =   3.45;
    _proton_fit_m[ 50. ] =   3.5 ;
    _proton_fit_m[ 50.5] =   3.5 ;
    _proton_fit_m[ 51. ] =   3.35;
    _proton_fit_m[ 51.5] =   3.3 ;
    _proton_fit_m[ 52. ] =   3.55;
    _proton_fit_m[ 52.5] =   3.5 ;
    _proton_fit_m[ 53. ] =   3.5 ;
    _proton_fit_m[ 53.5] =   3.55;
    _proton_fit_m[ 54. ] =   3.3 ;
    _proton_fit_m[ 54.5] =   3.25;
    _proton_fit_m[ 55. ] =   3.55;
    _proton_fit_m[ 55.5] =   3.25;
    _proton_fit_m[ 56. ] =   3.6 ;
    _proton_fit_m[ 56.5] =   3.2 ;
    _proton_fit_m[ 57. ] =   3.1 ;
    _proton_fit_m[ 57.5] =   3.15;
    _proton_fit_m[ 58. ] =   3.1 ;
    _proton_fit_m[ 58.5] =   3.25;
    _proton_fit_m[ 59. ] =   3.2 ;
    _proton_fit_m[ 59.5] =   3.25;
    _proton_fit_m[ 60. ] =   3.1 ;
    _proton_fit_m[ 60.5] =   3.25;
    _proton_fit_m[ 61. ] =   3.2 ;
    _proton_fit_m[ 61.5] =   3.2 ;
    _proton_fit_m[ 62. ] =   3.2 ;
    _proton_fit_m[ 62.5] =   3.2 ;
    _proton_fit_m[ 63. ] =   3.15;
    _proton_fit_m[ 63.5] =   3.1 ;
    _proton_fit_m[ 64. ] =   3.1 ;
    _proton_fit_m[ 64.5] =   3.1 ;
    _proton_fit_m[ 65. ] =   3.1 ;
    _proton_fit_m[ 65.5] =   3.1 ;
    _proton_fit_m[ 66. ] =   3.25;
    _proton_fit_m[ 66.5] =   3.05;
    _proton_fit_m[ 67. ] =   3.1 ;
    _proton_fit_m[ 67.5] =   3.  ;
    _proton_fit_m[ 68. ] =   3.35;
    _proton_fit_m[ 68.5] =   3.1 ;
    _proton_fit_m[ 69. ] =   3.1 ;
    _proton_fit_m[ 69.5] =   3.15;
    _proton_fit_m[ 70. ] =   3.1 ;
    _proton_fit_m[ 70.5] =   3.1 ;
    _proton_fit_m[ 71. ] =   3.2 ;
    _proton_fit_m[ 71.5] =   3.2 ;
    _proton_fit_m[ 72. ] =   3.  ;
    _proton_fit_m[ 72.5] =   3.  ;
    _proton_fit_m[ 73. ] =   2.95;
    _proton_fit_m[ 73.5] =   3.  ;
    _proton_fit_m[ 74. ] =   3.  ;
    _proton_fit_m[ 74.5] =   3.  ;
    _proton_fit_m[ 75. ] =   3.25;
    _proton_fit_m[ 75.5] =   3.  ;
    _proton_fit_m[ 76. ] =   3.  ;
    _proton_fit_m[ 76.5] =   3.  ;
    _proton_fit_m[ 77. ] =   3.25;
    _proton_fit_m[ 77.5] =   2.95;
    _proton_fit_m[ 78. ] =   2.65;
    _proton_fit_m[ 78.5] =   2.65;
    _proton_fit_m[ 79. ] =   3.  ;
    _proton_fit_m[ 79.5] =   3.3 ;
    _proton_fit_m[ 80. ] =   3.  ;
    _proton_fit_m[ 80.5] =   3.  ;
    _proton_fit_m[ 81. ] =   3.  ;
    _proton_fit_m[ 81.5] =   3.5 ;
    _proton_fit_m[ 82. ] =   3.1 ;
    _proton_fit_m[ 82.5] =   2.85;
    _proton_fit_m[ 83. ] =   2.65;
    _proton_fit_m[ 83.5] =   3.15;
    _proton_fit_m[ 84. ] =   2.8 ;
    _proton_fit_m[ 84.5] =   2.7 ;
    _proton_fit_m[ 85. ] =   2.9 ;
    _proton_fit_m[ 85.5] =   2.9 ;
    _proton_fit_m[ 86. ] =   2.95;
    _proton_fit_m[ 86.5] =   2.8 ;
    _proton_fit_m[ 87. ] =   2.95;
    _proton_fit_m[ 87.5] =   2.9 ;
    _proton_fit_m[ 88. ] =   2.9 ;
    _proton_fit_m[ 88.5] =   2.9 ;
    _proton_fit_m[ 89. ] =   2.9 ;
    _proton_fit_m[ 89.5] =   2.9 ;
    _proton_fit_m[ 90. ] =   2.85;
    _proton_fit_m[ 90.5] =   3.  ;
    _proton_fit_m[ 91. ] =   3.  ;
    _proton_fit_m[ 91.5] =   2.85;
    _proton_fit_m[ 92. ] =   3.  ;
    _proton_fit_m[ 92.5] =   3.  ;
    _proton_fit_m[ 93. ] =   3.  ;
    _proton_fit_m[ 93.5] =   3.  ;
    _proton_fit_m[ 94. ] =   2.85;
    _proton_fit_m[ 94.5] =   3.  ;
    _proton_fit_m[ 95. ] =   3.05;
    _proton_fit_m[ 95.5] =   3.05;
    _proton_fit_m[ 96. ] =   3.1 ;
    _proton_fit_m[ 96.5] =   2.9 ;
    _proton_fit_m[ 97. ] =   3.  ;
    _proton_fit_m[ 97.5] =   3.  ;
    _proton_fit_m[ 98. ] =   3.  ;
    _proton_fit_m[ 98.5] =   3.  ;
    _proton_fit_m[ 99. ] =   3.  ;
    _proton_fit_m[ 99.5] =   3.  ;
    _proton_fit_m[100. ] =   2.75;
    _proton_fit_m[100.5] =   3.05;
    _proton_fit_m[101. ] =   3.05;
    _proton_fit_m[101.5] =   2.85;
    _proton_fit_m[102. ] =   2.6 ;
    _proton_fit_m[102.5] =   3.05;
    _proton_fit_m[103. ] =   2.85;
    _proton_fit_m[103.5] =   2.85;
    _proton_fit_m[104. ] =   2.85;
    _proton_fit_m[104.5] =   2.8 ;
    _proton_fit_m[105. ] =   2.85;
    _proton_fit_m[105.5] =   2.9 ;
    _proton_fit_m[106. ] =   2.85;
    _proton_fit_m[106.5] =   2.8 ;
    _proton_fit_m[107. ] =   2.95;
    _proton_fit_m[107.5] =   2.85;
    _proton_fit_m[108. ] =   2.65;
    _proton_fit_m[108.5] =   2.65;
    _proton_fit_m[109. ] =   2.9 ;
    _proton_fit_m[109.5] =   2.8 ;
    _proton_fit_m[110. ] =   2.95;
    _proton_fit_m[110.5] =   2.85;
    _proton_fit_m[111. ] =   2.95;
    _proton_fit_m[111.5] =   2.7 ;
    _proton_fit_m[112. ] =   2.85;
    _proton_fit_m[112.5] =   2.8 ;
    _proton_fit_m[113. ] =   2.8 ;
    _proton_fit_m[113.5] =   2.8 ;
    _proton_fit_m[114. ] =   2.75;
    _proton_fit_m[114.5] =   2.65;
    _proton_fit_m[115. ] =   2.65;
    _proton_fit_m[115.5] =   2.65;
    _proton_fit_m[116. ] =   2.65;
    _proton_fit_m[116.5] =   2.65;
    _proton_fit_m[117. ] =   2.65;
    _proton_fit_m[117.5] =   2.65;
    _proton_fit_m[118. ] =   2.7 ;
    _proton_fit_m[118.5] =   2.7 ;
    _proton_fit_m[119. ] =   2.75;
    _proton_fit_m[119.5] =   2.7 ;
    _proton_fit_m[120. ] =   2.7 ;
    _proton_fit_m[120.5] =   2.75;
    _proton_fit_m[121. ] =   2.75;
    _proton_fit_m[121.5] =   2.7 ;
    _proton_fit_m[122. ] =   2.6 ;
    _proton_fit_m[122.5] =   2.7 ;
    _proton_fit_m[123. ] =   2.7 ;
    _proton_fit_m[123.5] =   2.6 ;
    _proton_fit_m[124. ] =   2.8 ;
    _proton_fit_m[124.5] =   2.75;
    _proton_fit_m[125. ] =   2.5 ;
    _proton_fit_m[125.5] =   2.7 ;
    _proton_fit_m[126. ] =   2.7 ;
    _proton_fit_m[126.5] =   2.7 ;
    _proton_fit_m[127. ] =   2.65;
    _proton_fit_m[127.5] =   2.6 ;
    _proton_fit_m[128. ] =   2.6 ;
    _proton_fit_m[128.5] =   2.65;
    _proton_fit_m[129. ] =   2.65;
    _proton_fit_m[129.5] =   2.6 ;
    _proton_fit_m[130. ] =   2.6 ;
    _proton_fit_m[130.5] =   2.65;
    _proton_fit_m[131. ] =   2.65;
    _proton_fit_m[131.5] =   2.75;
    _proton_fit_m[132. ] =   2.7 ;
    _proton_fit_m[132.5] =   2.2 ;
    _proton_fit_m[133. ] =   2.2 ;
    _proton_fit_m[133.5] =   2.7 ;
    _proton_fit_m[134. ] =   2.6 ;
    _proton_fit_m[134.5] =   2.8 ;
    _proton_fit_m[135. ] =   2.7 ;
    _proton_fit_m[135.5] =   2.85;
    _proton_fit_m[136. ] =   2.65;
    _proton_fit_m[136.5] =   2.65;
    _proton_fit_m[137. ] =   2.65;
    _proton_fit_m[137.5] =   2.6 ;
    _proton_fit_m[138. ] =   2.8 ;
    _proton_fit_m[138.5] =   2.6 ;
    _proton_fit_m[139. ] =   2.6 ;
    _proton_fit_m[139.5] =   2.65;
    _proton_fit_m[140. ] =   2.7 ;
    _proton_fit_m[140.5] =   2.75;
    _proton_fit_m[141. ] =   2.7 ;
    _proton_fit_m[141.5] =   2.7 ;
    _proton_fit_m[142. ] =   2.65;
    _proton_fit_m[142.5] =   2.65;
    _proton_fit_m[143. ] =   2.65;
    _proton_fit_m[143.5] =   2.65;
    _proton_fit_m[144. ] =   2.55;
    _proton_fit_m[144.5] =   2.55;
    _proton_fit_m[145. ] =   2.55;
    _proton_fit_m[145.5] =   2.65;
    _proton_fit_m[146. ] =   2.75;
    _proton_fit_m[146.5] =   2.5 ;
    _proton_fit_m[147. ] =   2.7 ;
    _proton_fit_m[147.5] =   2.75;
    _proton_fit_m[148. ] =   2.75;
    _proton_fit_m[148.5] =   2.4 ;
    _proton_fit_m[149. ] =   2.7 ;
    _proton_fit_m[149.5] =   2.45;
    _proton_fit_m[150. ] =   2.65;
    _proton_fit_m[150.5] =   2.6 ;
    _proton_fit_m[151. ] =   2.6 ;
    _proton_fit_m[151.5] =   2.8 ;
    _proton_fit_m[152. ] =   2.55;
    _proton_fit_m[152.5] =   2.4 ;
    _proton_fit_m[153. ] =   2.35;
    _proton_fit_m[153.5] =   2.35;
    _proton_fit_m[154. ] =   2.4 ;
    _proton_fit_m[154.5] =   2.5 ;
    _proton_fit_m[155. ] =   2.5 ;
    _proton_fit_m[155.5] =   2.45;
    _proton_fit_m[156. ] =   2.35;
    _proton_fit_m[156.5] =   2.35;
    _proton_fit_m[157. ] =   2.6 ;
    _proton_fit_m[157.5] =   2.35;
    _proton_fit_m[158. ] =   2.65;
    _proton_fit_m[158.5] =   2.65;
    _proton_fit_m[159. ] =   2.65;
    _proton_fit_m[159.5] =   2.65;
    _proton_fit_m[160. ] =   2.6 ;
    _proton_fit_m[160.5] =   2.6 ;
    _proton_fit_m[161. ] =   2.6 ;
    _proton_fit_m[161.5] =   2.6 ;
    _proton_fit_m[162. ] =   2.6 ;
    _proton_fit_m[162.5] =   2.6 ;
    _proton_fit_m[163. ] =   2.6 ;
    _proton_fit_m[163.5] =   2.55;
    _proton_fit_m[164. ] =   2.5 ;
    _proton_fit_m[164.5] =   2.5 ;
    _proton_fit_m[165. ] =   2.5 ;
    _proton_fit_m[165.5] =   2.5 ;
    _proton_fit_m[166. ] =   2.55;
    _proton_fit_m[166.5] =   2.55;
    _proton_fit_m[167. ] =   2.55;
    _proton_fit_m[167.5] =   2.55;
    _proton_fit_m[168. ] =   2.55;
    _proton_fit_m[168.5] =   2.55;
    _proton_fit_m[169. ] =   2.5 ;
    _proton_fit_m[169.5] =   2.5 ;
    _proton_fit_m[170. ] =   2.55;
    _proton_fit_m[170.5] =   2.55;
    _proton_fit_m[171. ] =   2.5 ;
    _proton_fit_m[171.5] =   2.65;
    _proton_fit_m[172. ] =   2.6 ;
    _proton_fit_m[172.5] =   2.45;
    _proton_fit_m[173. ] =   2.25;
    _proton_fit_m[173.5] =   2.1 ;
    _proton_fit_m[174. ] =   2.25;
    _proton_fit_m[174.5] =   2.95;
    _proton_fit_m[175. ] =   2.65;
  }

  float dEdxCalculator::ProtonEstimate(float rr) {
    float r = std::round(2.0*rr)/2.0;
    if (rr>84.5) r = 84.5;
    if (r<0.5)   r = 0.5; // hard cut off
    return _proton_m[r];
  }

  float dEdxCalculator::ProtonEstimateFit(float rr) {
    float r = std::round(2.0*rr)/2.0;
    if (r>175) r = 175;
    if (r<0.5) r = 0.5;
    return _proton_fit_m[r];
  }
  
  float dEdxCalculator::MuonEstimate(float rr) {
    float r = std::round(2.0*rr)/2.0;
    if (r>90.50) r = 90.50;
    if (r<1.50)  r = 1.50; // hard cut off
    return _muon_m[r];
  }

}


#endif
  
